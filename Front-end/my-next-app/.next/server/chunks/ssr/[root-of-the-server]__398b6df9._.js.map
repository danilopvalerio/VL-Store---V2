{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/danil/OneDrive/Documentos/2025/P6/web/PROJETOS/VL-Store---V2-develop/Front-end/my-next-app/src/pages/loginPage.tsx"],"sourcesContent":["// pages/authPage.tsx\nimport { useState } from \"react\";\nimport Head from \"next/head\";\nimport { useRouter } from \"next/router\";\nimport Link from \"next/link\";\nimport axios from \"axios\";\nimport \"../../public/css/login.css\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEye, faEyeSlash } from '@fortawesome/free-solid-svg-icons';\n\nconst AuthPage: React.FC = () => {\n  const router = useRouter();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [userType, setUserType] = useState(\"funcionario\");\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [passwordVisible, setPasswordVisible] = useState(false);\n\n  const pushInitialPage = () => {\n    router.push(\"/initialPage\");\n  };\n\n  const handleUserTypeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setUserType(e.target.value);\n  };\n\n  const togglePasswordVisibility = () => {\n    setPasswordVisible(prev => !prev);\n  };\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n    setLoading(true);\n\n    try {\n      if (!email || !password) {\n        setError(\"Email e senha são obrigatórios.\");\n        setLoading(false);\n        return;\n      }\n\n      const targetRoute =\n        userType === \"administrador\" ? \"login/loja\" : \"login/funcionario\";\n\n      const payload = {\n        email: email.toLowerCase(),\n        senha: password,\n      };\n\n      const response = await axios.post(\n        `http://localhost:9700/api/${targetRoute}`,\n        payload,\n        {\n          headers: { \"Content-Type\": \"application/json\" },\n        }\n      );\n\n      const data = response.data;\n\n      if (response.status === 200 && data.success && data.data?.token) {\n        localStorage.setItem(\"jwtToken\", data.data.token);\n        if (data.data.loja) {\n          localStorage.setItem(\"userData\", JSON.stringify(data.data.loja));\n        } else if (data.data.usuario) {\n          localStorage.setItem(\"userData\", JSON.stringify(data.data.usuario));\n        }\n\n        axios.defaults.headers.common[\n          \"Authorization\"\n        ] = `Bearer ${data.data.token}`;\n        router.push(\"/menuPage\");\n      } else {\n        setError(data.message || \"Usuário ou senha incorretos.\");\n      }\n    } catch (err: any) {\n      // Captura qualquer erro e seta o erro para o usuário\n      if (axios.isAxiosError(err)) {\n        setError(\n          err.response?.data?.message || `Erro na requisição: ${err.message}`\n        );\n      } else if (err instanceof Error) {\n        setError(`Erro inesperado: ${err.message}`);\n      } else {\n        setError(\"Erro desconhecido. Tente novamente.\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"d-flex justify-content-between flex-column min-vh-100\">\n      <Head>\n        <title>Login</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      </Head>\n\n      <header className=\"w-100\">\n        <div className=\"header-panel\">\n          <img\n            className=\"img logo\"\n            src=\"/vl-store-logo-white.svg\"\n            alt=\"VL Store Logo\"\n            onClick={pushInitialPage}\n            style={{ cursor: \"pointer\" }}\n          />\n        </div>\n      </header>\n      {error && <div className=\"alert alert-danger\">{error}</div>}\n      <main className=\"flex-grow-1 d-flex align-items-center\">\n        <div className=\"mx-auto login-register-block fine-transparent-border white-light d-flex justify-content-center align-items-center overflow-hidden w-75\">\n          <div className=\"row w-100 shadow overflow-hidden\">\n            <div className=\"col-md-6 text-white d-flex flex-column justify-content-center align-items-center text-center p-4 quartenary\">\n              <h4 className=\"m-3\">Bem-vindo!</h4>\n              <p className=\"w-75\">\n                Insira os seus dados de login para ter acesso ao sistema.\n              </p>\n            </div>\n\n            <div className=\"col-md-6 p-4 terciary\">\n              <h3 className=\"text-center mb-4\">Login</h3>\n\n              <form onSubmit={handleLogin}>\n                <div className=\"input-block row mb-2 align-items-center mb-3\">\n                  <div className=\"col-12 w-100\">\n                    <input\n                      type=\"email\"\n                      className=\"form-control input-form\"\n                      placeholder=\"Digite seu email\"\n                      value={email}\n                      onChange={(e) => setEmail(e.target.value)}\n                      disabled={loading}\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div className=\"input-block row mb-2 align-items-center mb-3\">\n                  <div className=\"col-12 w-100 position-relative\">\n                    <input\n                      type={passwordVisible ? \"text\" : \"password\"}\n                      className=\"form-control input-form\"\n                      placeholder=\"Digite sua senha\"\n                      value={password}\n                      onChange={(e) => setPassword(e.target.value)}\n                      disabled={loading}\n                      required\n                    />\n                    <span\n                      className=\"position-absolute top-50 end-0 translate-middle-y me-4\"\n                      style={{ cursor: 'pointer', zIndex: 100 }}\n                      onClick={togglePasswordVisibility}\n                    >\n                      <FontAwesomeIcon icon={passwordVisible ? faEyeSlash : faEye} />\n                   </span>\n                  </div>\n                   \n                </div>\n\n                <div className=\"row justify-content-center mb-3\">\n                  <div className=\"col-auto\">\n                    <div className=\"form-check form-check-inline\">\n                      <input\n                        className=\"form-check-input\"\n                        type=\"radio\"\n                        name=\"userType\"\n                        id=\"adminRadio\"\n                        value=\"administrador\"\n                        checked={userType === \"administrador\"}\n                        onChange={handleUserTypeChange}\n                        disabled={loading}\n                      />\n                      <label className=\"form-check-label\" htmlFor=\"adminRadio\">\n                        Administrador\n                      </label>\n                    </div>\n                  </div>\n\n                  <div className=\"col-auto\">\n                    <div className=\"form-check form-check-inline\">\n                      <input\n                        className=\"form-check-input\"\n                        type=\"radio\"\n                        name=\"userType\"\n                        id=\"employeeRadio\"\n                        value=\"funcionario\"\n                        checked={userType === \"funcionario\"}\n                        onChange={handleUserTypeChange}\n                        disabled={loading}\n                      />\n                      <label\n                        className=\"form-check-label\"\n                        htmlFor=\"employeeRadio\"\n                      >\n                        Funcionário\n                      </label>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"row mt-3 gap-1\">\n                  <button\n                    type=\"submit\"\n                    className=\"btn primaria col-11 col-lg-5 mx-auto d-flex justify-content-center align-items-center\"\n                    disabled={loading}\n                  >\n                    {loading ? \"Entrando...\" : \"Entrar\"}\n                  </button>\n                </div>\n\n                <p className=\"w-100 text-center mt-3\">\n                  Não possui conta? <Link href=\"/RegisterPage\">Cadastrar</Link>\n                </p>\n              </form>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      <footer className=\"w-100\">\n        <div className=\"footer-panel\">{/* Footer content if needed */}</div>\n      </footer>\n    </div>\n  );\n};\n\nexport default AuthPage;\n"],"names":[],"mappings":"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","debugId":null}}]
}