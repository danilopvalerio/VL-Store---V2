{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/danil/OneDrive/Documentos/2025/P6/web/PROJETOS/VL-Store---V2-develop/Front-end/my-next-app/src/pages/menuPage.tsx"],"sourcesContent":["import Head from \"next/head\";\r\nimport { useRouter } from \"next/router\";\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport \"../../public/css/general.css\";\r\nimport \"../../public/css/menu.css\";\r\n\r\nconst MenuPage: React.FC = () => {\r\n  const router = useRouter();\r\n  const [userName, setUserName] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isViewOnly, setIsViewOnly] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkAuth = async () => {\r\n      const jwtToken = localStorage.getItem(\"jwtToken\");\r\n      const userData = localStorage.getItem(\"userData\");\r\n      console.log(\"JWT token:\", jwtToken);\r\n      console.log(\"Parsed data:\", userData);\r\n\r\n      if (!jwtToken || !userData) {\r\n        router.push(\"/initialPage\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const parsedData = JSON.parse(userData);\r\n        let user;\r\n        const getUserFuncionario = async (\r\n          id: string,\r\n          jwtToken: string,\r\n          role: string\r\n        ) => {\r\n          if (role === \"funcionario\") {\r\n            const response = await axios.get(\r\n              `http://localhost:9700/api/funcionarios/${id}`,\r\n              {\r\n                headers: {\r\n                  Authorization: `Bearer ${jwtToken}`,\r\n                },\r\n                timeout: 2000,\r\n              }\r\n            );\r\n\r\n            const user = response.data.data;\r\n            return user.nome || \"Colaborador\";\r\n          }\r\n\r\n          return \"Colaborador\";\r\n        };\r\n\r\n        // depois do setUserName(parsedData.nome):\r\n        if (parsedData.role === \"funcionario\") {\r\n          setIsViewOnly(true);\r\n          const nome = await getUserFuncionario(\r\n            parsedData.id_funcionario,\r\n            jwtToken,\r\n            parsedData.role\r\n          );\r\n          setUserName(nome);\r\n        } else {\r\n          setIsViewOnly(false);\r\n          setUserName(parsedData.nome);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Erro ao parsear userData:\", error);\r\n        router.push(\"/initialPage\");\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [router]);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"jwtToken\");\r\n    localStorage.removeItem(\"userData\");\r\n    delete axios.defaults.headers.common[\"Authorization\"];\r\n    router.push(\"/initialPage\");\r\n  };\r\n\r\n  const navigateTo = (path: string) => {\r\n    router.push(path);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"d-flex justify-content-between align-items-center flex-column min-vh-100\">\r\n      <Head>\r\n        <title>VL Store</title>\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n      </Head>\r\n\r\n      <header className=\"w-100\">\r\n        <div className=\"header-panel\">\r\n          <img\r\n            src=\"/vl-store-logo-white.svg\"\r\n            alt=\"VL Store Logo\"\r\n            className=\"img logo\"\r\n          />\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"menu row w-75 white-light overflow-hidden rounded-5\">\r\n        <div className=\"col-md-6 text-white d-flex flex-column justify-content-center align-items-center text-center p-2 quinary\">\r\n          <h4 className=\"m-3\">VL Store</h4>\r\n          <h4 className=\"m-3\">Bem-vindo, {userName}!</h4>\r\n          <p className=\"w-75\">Sistema de Gestão Comercial</p>\r\n        </div>\r\n\r\n        <div className=\"col-md-6 terciary d-flex flex-column justify-content-center align-items-center text-center p-2\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn primaria col-9 col-lg-5 mb-2\"\r\n            onClick={() => navigateTo(\"/productsPage\")}\r\n          >\r\n            Produtos\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn primaria col-9 col-lg-5 mb-2\"\r\n            onClick={() => navigateTo(\"/cashierPage\")}\r\n            disabled={isViewOnly}\r\n          >\r\n            Caixas\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn primaria col-9 col-lg-5 mb-2\"\r\n            onClick={() => navigateTo(\"/employeesPage\")}\r\n            disabled={isViewOnly}\r\n          >\r\n            Funcionários\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn primaria col-9 col-lg-5 mb-2\"\r\n            onClick={() => navigateTo(\"/salesPage\")}\r\n          >\r\n            Vendas\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn primaria col-9 col-lg-5 mb-2\"\r\n            onClick={() => navigateTo(\"/reportsPage\")}\r\n            disabled={isViewOnly}\r\n          >\r\n            Relatórios\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn primaria col-9 col-lg-5 mb-2\"\r\n            onClick={() => navigateTo(\"/accountPage\")}\r\n            disabled={isViewOnly}\r\n          >\r\n            Conta\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <footer className=\"w-100\">\r\n        <div className=\"footer-panel\">\r\n          <button\r\n            className=\"btn primaria footerButton col-3 mx-auto d-flex justify-content-center align-items-center\"\r\n            onClick={handleLogout}\r\n          >\r\n            Sair\r\n          </button>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MenuPage;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}